<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Videos - Hunting Chronicle's</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-300 font-sans">

    <header class="fixed top-0 left-0 right-0 z-10 bg-gray-900/90 shadow-lg backdrop-blur-sm">
        <nav class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold text-orange-500 tracking-wider">Hunting Chronicle's</a>
            <div class="space-x-6 hidden md:flex">
                <a href="index.html" class="hover:text-orange-500 transition duration-300">Home</a>
                <a href="journal.html" class="hover:text-orange-500 transition duration-300">Journal</a>
                <a href="gallery.html" class="hover:text-orange-500 transition duration-300">Trophy Room</a>
                <a href="videos.html" class="hover:text-orange-500 transition duration-300">Videos</a>
                <a href="contact.html" class="hover:text-orange-500 transition duration-300">Uploads</a>
            </div>
            <button class="md:hidden text-gray-300 hover:text-orange-500">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </nav>
    </header>

    <main class="pt-24 pb-16 min-h-screen">
        <section id="videos" class="py-16">
            <div class="container mx-auto px-4">
                <h1 class="text-4xl font-bold mb-2 text-center">
                    <span class="text-orange-500">Hunting</span> Videos
                </h1>
                <p class="text-center text-gray-400 mb-12">Adventures, tips, and memorable moments from the field</p>
                
                <div id="videoGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="text-center text-gray-400 col-span-full py-8">
                        <p>No videos added yet. Add video URLs to display them here.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-center py-6 border-t border-gray-700">
        <p>&copy; 2024 Hunting Chronicle's. All rights reserved.</p>
    </footer>

    <script>
        // Add your YouTube video URLs here
        const videos = [
            'https://youtu.be/Rp44UiWZeNA?si=WGFuOO-0-oV0Egm4',
            'https://www.youtube.com/watch?v=muzneRfjZ_A&si=9gIwBq36z3vG5izB',
            'https://www.youtube.com/watch?v=YZ9aWQqD3K8'
        ];

        // Parse id and preserve si parameter if present
        function parseVideo(url) {
            let id = '';
            let si = '';
            if (url.includes('youtube.com/watch')) {
                const idMatch = url.match(/v=([^&]+)/);
                id = idMatch ? idMatch[1] : '';
                const siMatch = url.match(/si=([^&]+)/);
                si = siMatch ? siMatch[1] : '';
            } else if (url.includes('youtu.be/')) {
                const idMatch = url.match(/youtu\.be\/([^?&]+)/);
                id = idMatch ? idMatch[1] : '';
                const siMatch = url.match(/si=([^&]+)/);
                si = siMatch ? siMatch[1] : '';
            }
            return { id, si, original: url };
        }

        // Build embed src with preserved si param and enablejsapi for error detection
        function buildEmbedSrc(id, si) {
            let src = `https://www.youtube.com/embed/${id}`;
            const params = [];
            if (si) params.push(`si=${si}`);
            // enable JS API so we can listen for player errors
            params.push('enablejsapi=1');
            params.push('rel=0');
            if (params.length) src += `?${params.join('&')}`;
            return src;
        }

        // Insert placeholders and then create YT players to detect errors (101/150/153 etc.)
        function loadVideos() {
            const videoGrid = document.getElementById('videoGrid');
            if (!videoGrid) return;
            videoGrid.innerHTML = '';

            videos.forEach((url, idx) => {
                const { id, si, original } = parseVideo(url);
                if (!id) {
                    const linkDiv = document.createElement('div');
                    linkDiv.className = 'rounded-lg overflow-hidden shadow-xl bg-gray-800 flex items-center justify-center h-64';
                    linkDiv.innerHTML = `<a href="${original}" target="_blank" class="text-orange-500 hover:text-orange-400 underline text-center px-4">Invalid URL<br><small>Click to open on YouTube</small></a>`;
                    videoGrid.appendChild(linkDiv);
                    return;
                }

                const container = document.createElement('div');
                container.className = 'rounded-lg overflow-hidden shadow-xl bg-gray-800';

                const iframeId = `player-embed-${idx}`;
                const iframe = document.createElement('iframe');
                iframe.id = iframeId;
                iframe.width = '100%';
                iframe.height = '315';
                iframe.frameBorder = '0';
                iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
                iframe.referrerPolicy = 'strict-origin-when-cross-origin';
                iframe.allowFullscreen = true;
                iframe.src = buildEmbedSrc(id, si);

                container.appendChild(iframe);
                videoGrid.appendChild(container);

                // After API is ready we'll attach a player to listen for errors
                playersToInit.push({ id: iframeId, container, original });
            });
        }

        // Queue of players to initialize once API is ready
        const playersToInit = [];

        // Load YouTube IFrame API and initialize players
        function initYouTubeAPI() {
            if (typeof YT === 'undefined' || typeof YT.Player === 'undefined') {
                // load the API script
                const tag = document.createElement('script');
                tag.src = 'https://www.youtube.com/iframe_api';
                document.body.appendChild(tag);
            } else {
                onYouTubeIframeAPIReady();
            }
        }

        // This function is called by the IFrame API when ready
        function onYouTubeIframeAPIReady() {
            playersToInit.forEach(item => {
                try {
                    new YT.Player(item.id, {
                        events: {
                            onError: function(event) {
                                // If player gives an error (101/150/153 etc.), replace with a link
                                const container = item.container;
                                container.innerHTML = `<div class="p-6 text-center"><a href="${item.original}" target="_blank" class="text-orange-500 hover:text-orange-400 underline">Unable to embed video<br><small>Click to watch on YouTube</small></a></div>`;
                            }
                        }
                    });
                } catch (e) {
                    // If anything goes wrong, fallback to link
                    const container = item.container;
                    container.innerHTML = `<div class="p-6 text-center"><a href="${item.original}" target="_blank" class="text-orange-500 hover:text-orange-400 underline">Unable to embed video<br><small>Click to watch on YouTube</small></a></div>`;
                }
            });
        }

        // Start
        loadVideos();
        initYouTubeAPI();

        // Expose the API-ready handler to the global scope (YouTube will call this)
        window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
    </script>
</body>
</html>
